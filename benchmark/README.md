# Benchmarks

## Sample apps

All apps employ two global middlewares with `req` mutations, an empty `GET` route handler for `favicon.ico` and a GET handler for the `/users/:id`, returning a `User: {id}` string response.

## Benchmarking command

Results are taken after 1 warm-up run. The tool used for results is the following:

```sh
autocannon -c 100 -d 15 http://localhost:3000/user/123
```

## Information

### Hardware

Xiaomi Laptop with 16GB RAM and Intel Core i7-8550U processor.

### Software

- **OS**: Manjaro Linux
- **Kernel version**: 5.6.16-1-MANJARO
- **Node.js**: 14.5.0

## Results

> Note that benchmarks aren't completely accurate and are different on every run.

| framework           | req/s | transfer/sec |
| ------------------- | ----- | ------------ |
| @tinyhttp/app (esm) | 8580  | 927KB        |
| @tinyhttp/app (cjs) | 8067  | 871KB        |
| express@4.17.1      | 6897  | 904KB        |
| polka@0.5.2         | 22831 | 2.47MB       |

## Detailed results

- tinyhttp (esm)

```
┌─────────┬──────┬───────┬───────┬───────┬──────────┬─────────┬──────────┐
│ Stat    │ 2.5% │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev   │ Max      │
├─────────┼──────┼───────┼───────┼───────┼──────────┼─────────┼──────────┤
│ Latency │ 6 ms │ 11 ms │ 16 ms │ 17 ms │ 10.87 ms │ 3.63 ms │ 69.48 ms │
└─────────┴──────┴───────┴───────┴───────┴──────────┴─────────┴──────────┘
┌───────────┬────────┬────────┬────────┬─────────┬─────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%   │ Avg     │ Stdev   │ Min    │
├───────────┼────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Req/Sec   │ 6211   │ 6211   │ 8503   │ 14239   │ 8780.14 │ 2260.11 │ 6209   │
├───────────┼────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Bytes/Sec │ 671 kB │ 671 kB │ 918 kB │ 1.54 MB │ 948 kB  │ 244 kB  │ 671 kB │
└───────────┴────────┴────────┴────────┴─────────┴─────────┴─────────┴────────┘

Req/Bytes counts sampled once per second.

132k requests in 15.08s, 14.2 MB read

```

- tinyhttp (cjs)

```
┌─────────┬──────┬───────┬───────┬───────┬──────────┬─────────┬──────────┐
│ Stat    │ 2.5% │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev   │ Max      │
├─────────┼──────┼───────┼───────┼───────┼──────────┼─────────┼──────────┤
│ Latency │ 6 ms │ 11 ms │ 16 ms │ 19 ms │ 10.98 ms │ 3.57 ms │ 59.52 ms │
└─────────┴──────┴───────┴───────┴───────┴──────────┴─────────┴──────────┘
┌───────────┬────────┬────────┬────────┬─────────┬─────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%   │ Avg     │ Stdev   │ Min    │
├───────────┼────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Req/Sec   │ 6171   │ 6171   │ 8107   │ 13727   │ 8695.47 │ 2257.32 │ 6168   │
├───────────┼────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Bytes/Sec │ 667 kB │ 667 kB │ 876 kB │ 1.48 MB │ 939 kB  │ 244 kB  │ 666 kB │
└───────────┴────────┴────────┴────────┴─────────┴─────────┴─────────┴────────┘

Req/Bytes counts sampled once per second.

130k requests in 15.08s, 14.1 MB read
```

- express@4.17.1

```
┌─────────┬───────┬───────┬───────┬───────┬──────────┬─────────┬──────────┐
│ Stat    │ 2.5%  │ 50%   │ 97.5% │ 99%   │ Avg      │ Stdev   │ Max      │
├─────────┼───────┼───────┼───────┼───────┼──────────┼─────────┼──────────┤
│ Latency │ 10 ms │ 12 ms │ 26 ms │ 32 ms │ 14.04 ms │ 4.63 ms │ 65.17 ms │
└─────────┴───────┴───────┴───────┴───────┴──────────┴─────────┴──────────┘
┌───────────┬────────┬────────┬────────┬─────────┬─────────┬─────────┬────────┐
│ Stat      │ 1%     │ 2.5%   │ 50%    │ 97.5%   │ Avg     │ Stdev   │ Min    │
├───────────┼────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Req/Sec   │ 3557   │ 3557   │ 7247   │ 8519    │ 6897.27 │ 1423.07 │ 3557   │
├───────────┼────────┼────────┼────────┼─────────┼─────────┼─────────┼────────┤
│ Bytes/Sec │ 466 kB │ 466 kB │ 950 kB │ 1.12 MB │ 904 kB  │ 186 kB  │ 466 kB │
└───────────┴────────┴────────┴────────┴─────────┴─────────┴─────────┴────────┘

Req/Bytes counts sampled once per second.

103k requests in 15.09s, 13.6 MB read
```

- polka@0.5.2

```
┌─────────┬──────┬──────┬───────┬──────┬─────────┬─────────┬──────────┐
│ Stat    │ 2.5% │ 50%  │ 97.5% │ 99%  │ Avg     │ Stdev   │ Max      │
├─────────┼──────┼──────┼───────┼──────┼─────────┼─────────┼──────────┤
│ Latency │ 3 ms │ 4 ms │ 6 ms  │ 9 ms │ 4.11 ms │ 1.42 ms │ 50.78 ms │
└─────────┴──────┴──────┴───────┴──────┴─────────┴─────────┴──────────┘
┌───────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┬─────────┐
│ Stat      │ 1%      │ 2.5%    │ 50%     │ 97.5%   │ Avg     │ Stdev   │ Min     │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Req/Sec   │ 11687   │ 11687   │ 23647   │ 24175   │ 22831.2 │ 2998.21 │ 11681   │
├───────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┼─────────┤
│ Bytes/Sec │ 1.26 MB │ 1.26 MB │ 2.55 MB │ 2.61 MB │ 2.47 MB │ 324 kB  │ 1.26 MB │
└───────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┴─────────┘

Req/Bytes counts sampled once per second.

342k requests in 15.09s, 37 MB read
```
